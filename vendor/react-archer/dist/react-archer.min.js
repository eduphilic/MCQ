!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("react"),require("prop-types")):"function"==typeof define&&define.amd?define(["react","prop-types"],e):"object"==typeof exports?exports.ReactArcher=e(require("react"),require("prop-types")):t.ReactArcher=e(t.React,t.PropTypes)}(this,function(t,e){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="dist/",e(e.s=2)}([function(e,r){e.exports=t},function(t,r){t.exports=e},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=r(3);Object.defineProperty(e,"ArcherElement",{enumerable:!0,get:function(){return n(o).default}});var i=r(4);Object.defineProperty(e,"ArcherContainer",{enumerable:!0,get:function(){return n(i).default}})},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.ArcherElement=void 0;var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},u=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),c=r(0),f=n(c),l=r(1),h=n(l),d=function(t){var e=(t||[]).map(function(t){return t.label&&t.label.props?JSON.stringify(t.label.props):JSON.stringify(t.label)});return JSON.stringify(e)},p=e.ArcherElement=function(t){function e(){return o(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return s(e,t),u(e,[{key:"componentWillReceiveProps",value:function(t){d(this.props.relations)!==d(t.relations)&&this.registerAllTransitions(t.relations)}},{key:"componentDidMount",value:function(){this.props.relations&&this.registerAllTransitions(this.props.relations)}},{key:"registerAllTransitions",value:function(t){var e=this;t.forEach(function(t){e.context.registerTransition(e.props.id,t)})}},{key:"render",value:function(){return f.default.createElement("div",{style:a({},this.props.style,{position:"relative"}),className:this.props.className,ref:this.context.registerChild(this.props.id)},this.props.children)}}]),e}(f.default.Component);p.contextTypes={registerChild:h.default.func,registerTransition:h.default.func,refresh:h.default.func};var v=h.default.oneOf(["top","bottom","left","right"]);p.propTypes={id:h.default.string,relations:h.default.arrayOf(h.default.shape({label:h.default.node,from:h.default.shape({anchor:v}),to:h.default.shape({anchor:v,id:h.default.string})})),style:h.default.object,className:h.default.string,children:h.default.node},e.default=p},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function c(t){return new _.default(t.left,t.top)}function f(t,e){switch(t){case"top":return c(e).add(new _.default(e.width/2,0));case"bottom":return c(e).add(new _.default(e.width/2,e.height));case"left":return c(e).add(new _.default(0,e.height/2));case"right":return c(e).add(new _.default(e.width,e.height/2));default:return new _.default(0,0)}}Object.defineProperty(e,"__esModule",{value:!0}),e.ArcherContainer=void 0;var l=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},h=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),d=r(0),p=n(d),v=r(1),b=n(v),y=r(5),m=n(y),g=r(7),_=n(g),w=r(8),O=n(w),E={position:"absolute",width:"100%",height:"100%",top:0,left:0},x=e.ArcherContainer=function(t){function e(t){s(this,e);var r=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));r.refreshScreen=function(){r.setState(l({},r.state))},r.getChildContext=function(){return{registerTransition:r.registerTransition,registerChild:r.registerChild}},r.storeParent=function(t){r.state.parent||r.setState(function(e){return l({},e,{parent:t})})},r.getRectFromRef=function(t){return t?t.getBoundingClientRect():new _.default(0,0)},r.getParentCoordinates=function(){return c(r.getRectFromRef(r.state.parent))},r.getPointCoordinatesFromAnchorPosition=function(t,e,n){return f(t,r.getRectFromRef(r.state.refs[e])).substract(n)},r.registerTransition=function(t,e){var n=[].concat(i(r.state.fromTo)),o=l({},e,{from:l({},e.from,{id:t})});n.push(o),r.setState(function(t){return l({},r.currentState,{fromTo:[].concat(i(t.fromTo),i(n))})})},r.registerChild=function(t){return function(e){r.state.refs[t]||(r.state.observer.observe(e),r.setState(function(n){return l({},r.currentState,{refs:l({},n.refs,o({},t,e))})}))}},r.computeArrows=function(){var t=r.getParentCoordinates();return r.state.fromTo.map(function(e){var n=e.from,o=e.to,i=e.label,s=n.anchor,a=r.getPointCoordinatesFromAnchorPosition(n.anchor,n.id,t),u=o.anchor,c=r.getPointCoordinatesFromAnchorPosition(o.anchor,o.id,t);return p.default.createElement(O.default,{key:JSON.stringify({from:n,to:o}),startingPoint:a,startingAnchor:s,endingPoint:c,endingAnchor:u,strokeColor:r.props.strokeColor,arrowLength:r.props.arrowLength,strokeWidth:r.props.strokeWidth,arrowLabel:i})})};var n=new m.default(function(){r.refreshScreen()});return r.state={refs:{},fromTo:[],observer:n},r}return u(e,t),h(e,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.refreshScreen)}},{key:"componentWillUnmount",value:function(){var t=this;Object.keys(this.state.refs).map(function(e){t.state.observer.unobserve(t.state.refs[e])}),window.removeEventListener("resize",this.refreshScreen)}},{key:"render",value:function(){var t=this.computeArrows(),e="M0,0 L0,"+this.props.arrowThickness+" L"+(this.props.arrowLength-1)+","+this.props.arrowThickness/2+" z";return p.default.createElement("div",{style:l({},this.props.style,{position:"relative"}),className:this.props.className},p.default.createElement("svg",{style:E},p.default.createElement("defs",null,p.default.createElement("marker",{id:"arrow",markerWidth:this.props.arrowLength,markerHeight:this.props.arrowThickness,refX:"0",refY:this.props.arrowThickness/2,orient:"auto",markerUnits:"strokeWidth"},p.default.createElement("path",{d:e,fill:this.props.strokeColor}))),t),p.default.createElement("div",{ref:this.storeParent},this.props.children))}}]),e}(p.default.Component);x.propTypes={arrowLength:b.default.number,arrowThickness:b.default.number,strokeColor:b.default.string,strokeWidth:b.default.number,children:b.default.node,style:b.default.object,className:b.default.string},x.defaultProps={arrowLength:10,arrowThickness:6,strokeColor:"#f00",strokeWidth:2},x.childContextTypes={registerChild:b.default.func,registerTransition:b.default.func},e.default=x},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){function r(t){return parseFloat(t)||0}function n(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return e.reduce(function(e,n){return e+r(t["border-"+n+"-width"])},0)}function o(t){for(var e=["top","right","bottom","left"],n={},o=0,i=e;o<i.length;o+=1){var s=i[o],a=t["padding-"+s];n[s]=r(a)}return n}function i(t){var e=t.getBBox();return f(0,0,e.width,e.height)}function s(t){var e=t.clientWidth,i=t.clientHeight;if(!e&&!i)return O;var s=w(t).getComputedStyle(t),u=o(s),c=u.left+u.right,l=u.top+u.bottom,h=r(s.width),d=r(s.height);if("border-box"===s.boxSizing&&(Math.round(h+c)!==e&&(h-=n(s,"left","right")+c),Math.round(d+l)!==i&&(d-=n(s,"top","bottom")+l)),!a(t)){var p=Math.round(h+c)-e,v=Math.round(d+l)-i;1!==Math.abs(p)&&(h-=p),1!==Math.abs(v)&&(d-=v)}return f(u.left,u.top,h,d)}function a(t){return t===w(t).document.documentElement}function u(t){return h?E(t)?i(t):s(t):O}function c(t){var e=t.x,r=t.y,n=t.width,o=t.height,i="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,s=Object.create(i.prototype);return _(s,{x:e,y:r,width:n,height:o,top:r,right:e+n,bottom:o+r,left:e}),s}function f(t,e,r,n){return{x:t,y:e,width:r,height:n}}var l=function(){function t(t,e){var r=-1;return t.some(function(t,n){return t[0]===e&&(r=n,!0)}),r}return"undefined"!=typeof Map?Map:function(){function e(){this.__entries__=[]}var r={size:{configurable:!0}};return r.size.get=function(){return this.__entries__.length},e.prototype.get=function(e){var r=t(this.__entries__,e),n=this.__entries__[r];return n&&n[1]},e.prototype.set=function(e,r){var n=t(this.__entries__,e);~n?this.__entries__[n][1]=r:this.__entries__.push([e,r])},e.prototype.delete=function(e){var r=this.__entries__,n=t(r,e);~n&&r.splice(n,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){var r=this;void 0===e&&(e=null);for(var n=0,o=r.__entries__;n<o.length;n+=1){var i=o[n];t.call(e,i[1],i[0])}},Object.defineProperties(e.prototype,r),e}()}(),h="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,d=function(){return void 0!==t&&t.Math===Math?t:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")()}(),p=function(){return"function"==typeof requestAnimationFrame?requestAnimationFrame.bind(d):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)}}(),v=2,b=function(t,e){function r(){i&&(i=!1,t()),s&&o()}function n(){p(r)}function o(){var t=Date.now();if(i){if(t-a<v)return;s=!0}else i=!0,s=!1,setTimeout(n,e);a=t}var i=!1,s=!1,a=0;return o},y=["top","right","bottom","left","width","height","size","weight"],m="undefined"!=typeof MutationObserver,g=function(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=b(this.refresh.bind(this),20)};g.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},g.prototype.removeObserver=function(t){var e=this.observers_,r=e.indexOf(t);~r&&e.splice(r,1),!e.length&&this.connected_&&this.disconnect_()},g.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},g.prototype.updateObservers_=function(){var t=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return t.forEach(function(t){return t.broadcastActive()}),t.length>0},g.prototype.connect_=function(){h&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),m?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},g.prototype.disconnect_=function(){h&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},g.prototype.onTransitionEnd_=function(t){var e=t.propertyName;void 0===e&&(e=""),y.some(function(t){return!!~e.indexOf(t)})&&this.refresh()},g.getInstance=function(){return this.instance_||(this.instance_=new g),this.instance_},g.instance_=null;var _=function(t,e){for(var r=0,n=Object.keys(e);r<n.length;r+=1){var o=n[r];Object.defineProperty(t,o,{value:e[o],enumerable:!1,writable:!1,configurable:!0})}return t},w=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||d},O=f(0,0,0,0),E=function(){return"undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof w(t).SVGGraphicsElement}:function(t){return t instanceof w(t).SVGElement&&"function"==typeof t.getBBox}}(),x=function(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=f(0,0,0,0),this.target=t};x.prototype.isActive=function(){var t=u(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},x.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t};var A=function(t,e){var r=c(e);_(this,{target:t,contentRect:r})},k=function(t,e,r){if(this.activeObservations_=[],this.observations_=new l,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=e,this.callbackCtx_=r};k.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof w(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new x(t)),this.controller_.addObserver(this),this.controller_.refresh())}},k.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof w(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},k.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},k.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(e){e.isActive()&&t.activeObservations_.push(e)})},k.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map(function(t){return new A(t.target,t.broadcastRect())});this.callback_.call(t,e,t),this.clearActive()}},k.prototype.clearActive=function(){this.activeObservations_.splice(0)},k.prototype.hasActive=function(){return this.activeObservations_.length>0};var T="undefined"!=typeof WeakMap?new WeakMap:new l,P=function(t){if(!(this instanceof P))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var e=g.getInstance(),r=new k(t,e,this);T.set(this,r)};["observe","unobserve","disconnect"].forEach(function(t){P.prototype[t]=function(){return(e=T.get(this))[t].apply(e,arguments);var e}});var j=function(){return void 0!==d.ResizeObserver?d.ResizeObserver:P}();e.default=j}.call(e,r(6))},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";function n(t,e){return this.x=t,this.y=e,this}Object.defineProperty(e,"__esModule",{value:!0}),n.prototype.add=function(t){return new n(this.x+t.x,this.y+t.y)},n.prototype.substract=function(t){return new n(this.x-t.x,this.y-t.y)},e.default=n},function(t,e,r){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t){switch(t){case"left":return{arrowX:-1,arrowY:0};case"right":return{arrowX:1,arrowY:0};case"top":return{arrowX:0,arrowY:-1};case"bottom":return{arrowX:0,arrowY:1};default:return{arrowX:0,arrowY:0}}}function i(t,e,r,n,i){var s=o(i);return{xe:t+s.arrowX*r*n/2,ye:e+s.arrowY*r*n/2}}function s(t,e,r,n,o){return"top"===o||"bottom"===o?{xa1:t,ya1:e+(n-e)/2}:"left"===o||"right"===o?{xa1:t+(r-t)/2,ya1:e}:{xa1:t,ya1:e}}function a(t,e,r,n,o){return"top"===o||"bottom"===o?{xa2:r,ya2:n-(n-e)/2}:"left"===o||"right"===o?{xa2:r-(r-t)/2,ya2:n}:{xa2:r,ya2:n}}function u(t,e,r,n){var o=Math.abs(r-t),i=Math.abs(n-e);return{xl:r>t?t:r,yl:n>e?e:n,wl:o,hl:i}}Object.defineProperty(e,"__esModule",{value:!0}),e.computeEndingPointAccordingToArrow=i,e.computeStartingAnchorPosition=s,e.computeEndingAnchorPosition=a,e.computeLabelDimensions=u;var c=r(0),f=n(c),l=r(1),h=n(l),d=function(t){var e=t.startingPoint,r=t.startingAnchor,n=t.endingPoint,o=t.endingAnchor,c=t.strokeColor,l=t.arrowLength,h=t.strokeWidth,d=t.arrowLabel,p=2*l,v=e.x,b=e.y,y=i(n.x,n.y,p,h,o),m=y.xe,g=y.ye,_=s(v,b,m,g,r),w=_.xa1,O=_.ya1,E=a(v,b,m,g,o),x=E.xa2,A=E.ya2,k="M"+v+","+b+" C"+w+","+O+" "+x+","+A+" "+m+","+g,T=u(v,b,m,g),P=T.xl,j=T.yl,M=T.wl,C=T.hl;return f.default.createElement("g",null,f.default.createElement("path",{d:k,style:{fill:"none",stroke:c,strokeWidth:h},markerEnd:"url("+location.href+"#arrow)"}),f.default.createElement("foreignObject",{x:P,y:j,width:M,height:C},f.default.createElement("div",{style:{width:M,height:C,display:"flex",alignItems:"center",justifyContent:"center"}},f.default.createElement("div",null,d))))},p=h.default.shape({x:h.default.number,y:h.default.number}),v=h.default.oneOf(["top","bottom","left","right"]);d.propTypes={startingPoint:p,startingAnchor:v,endingPoint:p,endingAnchor:v,strokeColor:h.default.string,arrowLength:h.default.number,strokeWidth:h.default.number,arrowLabel:h.default.node},e.default=d}])});